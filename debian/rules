#!/usr/bin/make -f
# See debhelper(7) (uncomment to enable)
# output every command that modifies files on the build system.
#export DH_VERBOSE = 1

# see FEATURE AREAS in dpkg-buildflags(1)
export DEB_BUILD_MAINT_OPTIONS = hardening=-pie

DPKG_EXPORT_BUILDFLAGS	 = 1
include /usr/share/dpkg/buildflags.mk

INSTALLDIR=selfie

DEB_HOST_MULTIARCH	?= $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)

get_package_version	 = $(shell dpkg-query -W -f '$${Version}' $1)

%:
	dh $@ --with autoreconf

.PHONY: override_dh_auto_configure
override_dh_auto_configure:
	dh_auto_configure -- --prefix=/opt/$(INSTALLDIR) --with-posixio --with-mpi --with-papi

override_dh_install:
	dh_install

	# Replace and install module files
	mkdir -p debian/$(INSTALLDIR)/opt/modulefiles/
	cp -a debian/modules/*	debian/$(INSTALLDIR)/opt/modulefiles/
